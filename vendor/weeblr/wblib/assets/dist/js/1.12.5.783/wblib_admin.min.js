/*! Copyright WeeblrPress - Weeblr,llc 2019 - Licence: http://www.gnu.org/copyleft/gpl.html GNU/GPL */
!function(s,i,d,p){"use strict";var n=".js-wbamp-media-manager-field",e=".js-wbamp-media-manager-button",a=".js-wblib-color-picker",t=".js-wbamp-clear-transients-button",r=".js-wbamp-flush-rewrite-rules-button",o=[],l=null;function c(e){e.preventDefault();var i=p(this),a=i.prev(n).first(),t=a.attr("id");if(wp.media.frames.wblib_media_manager=wp.media.frames.wblib_media_manager||{},!wp.media.frames.wblib_media_manager[t]){wp.media.frames.wblib_media_manager[t]=wp.media({title:i.data("media-title"),multiple:!1,library:{type:i.data("media-type")},button:{text:i.data("media-button")}});wp.media.frames.wblib_media_manager[t].on("select",function(){var e=wp.media.frames.wblib_media_manager[t].state().get("selection");e&&e.each(function(e){!function(e,i,a){var t=a.attr("id"),s=i.data("media-min-width"),n=i.data("media-min-height"),r=i.data("media-max-width"),o=i.data("media-max-height"),d=e.attributes.width,l=[];s&&d<s&&l.push(e.attributes.filename+" is not wide enough. Minimal width is: "+s+" pixels.");r&&r<d&&l.push(e.attributes.filename+" is too wide. Maximal width is: "+r+" pixels.");var c=e.attributes.height;n&&c<n&&l.push(e.attributes.filename+" is not tall enough. Minimal height is: "+n+" pixels.");o&&o<c&&l.push(e.attributes.filename+" is too tall. Maximal height is: "+o+" pixels.");var u=p("#js-wbamp-warning-"+t);u.empty();var m=e.attributes.url;if(a.val(m),i.data("media-preview")){var h=p("<img />").attr("src",m);p("#js-"+t+"-preview").empty().append(h)}l.length&&(u=p('<div class="wbamp-ajax-response-msg-failure" id="js-wbamp-warning-'+t+'"></div>'),i.after(u),l.push("We will try to resize that image when you save the settings."),u.html("<ul><li>"+l.join("</li><li>")+"</li>"))}(e,i,a)})})}wp.media.frames.wblib_media_manager[t].open()}function u(e){e.preventDefault();var i=p(this),a={action:"wblib_config_action",config_item:"clear_transients",_ajax_nonce:s.ajax_nonces.clear_transients||""},t=p("#js-wbamp-clear-transients-msg").hide();s.spinner.start("js-wbamp-clear-transients-spinner",{class:"wbl-spinner-css-12"}),i.prop("disabled","disabled"),p.post(ajaxurl,a).done(function(e){console.debug(e),s.spinner.stop("js-wbamp-clear-transients-spinner"),h(e,t),i.prop("disabled",!1)})}function m(e){e.preventDefault();var i=p(this),a={action:"wblib_config_action",config_item:"flush_rewrite_rules",_ajax_nonce:s.ajax_nonces.flush_rewrite_rules||""},t=p("#js-wbamp-flush-rewrite-rules-msg").hide();s.spinner.start("js-wbamp-flush-rewrite-rules-spinner",{class:"wbl-spinner-css-12"}),i.prop("disabled","disabled"),p.post(ajaxurl,a).done(function(e){console.debug(e),s.spinner.stop("js-wbamp-flush-rewrite-rules-spinner"),h(e,t),i.prop("disabled",!1)})}function h(e,i){e.success?(i.removeClass("wbamp-ajax-response-msg-failure").addClass("wbamp-ajax-response-msg-success").html(e.data).fadeIn(),setTimeout(function(){i.hide()},5e3)):i.removeClass("wbamp-ajax-response-msg-success").addClass("wbamp-ajax-response-msg-failure").html(e.data).fadeIn()}function b(e,i){var a={},t=p(i),s=t.attr("class"),n=s&&s.split(" ");if(p.each(n,function(){"js-data"==this.substr(0,7)&&(a.hideable_id=this,a.$hideable_id=p("."+this),a.data_source=this.substr(8))}),t.data("always_hide"))return a.always_hide=!0,void o.push(a);var r=p("#"+a.data_source);r.length&&(a.show_if_id=r.data("show_if_id"),a.show_if_id=a.show_if_id&&a.show_if_id.toString().split(" "),a.show_include=r.data("show_include"),a.show_include=a.show_include&&a.show_include.toString().split(" "),a.show_exclude=r.data("show_exclude"),a.show_exclude=a.show_exclude&&a.show_exclude.toString().split(" ")),a.show_if_id&&(a.$show_trigger=[],p.each(a.show_if_id,function(e,i){a.$show_trigger.push(p("#"+i))}),a.data_source&&a.$show_trigger.length&&(p.each(a.$show_trigger,function(e,i){a.$show_trigger[e].on("change",w)}),o.push(a)))}function w(){p.each(o,function(e,i){i.always_hide?i.$hideable_id.fadeOut():function(n){var r;return p.each(n.$show_trigger,function(e,i){var a=n.$show_trigger[e],t=a.val();if("checkbox"==a.prop("type")){var s=function(e,i){if(-1!=p.inArray("checked",e.show_include))return!!i.prop("checked");if(-1!=p.inArray("unchecked",e.show_include))return!i.prop("checked")}(n,a);r=void 0===r?s:r||s}r=n.show_exclude&&-1!=p.inArray(t,n.show_exclude)?void 0!==r&&r:n.show_include?-1!=p.inArray(t,n.show_include)?void 0===r||r:void 0!==r&&r:void 0===r||r}),r}(i)?i.$hideable_id.fadeIn():i.$hideable_id.fadeOut()})}function _(e){e.preventDefault(),l.click(),i.location="#"}function f(e,i,a,t,s){var n=1/0===(a=parseInt(a)||1/0)?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+a;t=t||"/";var r=s?"; secure":"",o=encodeURIComponent(e)+"="+encodeURIComponent(i)+n+"; path="+t+r;d.cookie=o}var g=[],v={};function j(e){e&&e.preventDefault();var i=p(this),t=i.attr("id");g[t]||(g[t]={url:i.attr("href"),embed_url:i.data("embed_url"),embed_url_hash:i.data("embed_url_hash"),id:i.data("id"),hash:i.data("hash"),state:i.data("state")},g[t].button_id="wblib-doc-btn-"+g[t].hash,g[t].frame_id="wblib-doc-frame-"+g[t].hash,g[t].frame_container_id="wblib-doc-frame-container-"+g[t].hash,g[t].spinner_id="wblib-doc-spinner-"+g[t].hash),"opened"!=g[t].state?(p("#js-wbamp-settings-doc-msg-"+g[t].hash).empty(),v[g[t].embed_url]?y(g[t],v[g[t].embed_url]):(function(e){s.spinner.start(e.spinner_id,{class:"wbl-spinner-css-12"})}(g[t]),jQuery.ajax({url:g[t].embed_url,error:function(e,i,a){x(g[t]),console.error("Error fetching documentation page "+g[t].id+", status: "+i+", code: "+e.status),p("#js-wbamp-settings-doc-msg-"+g[t].hash).html("Sorry, could not load help from server. Please try again later."),setTimeout(function(){p("#js-wbamp-settings-doc-msg-"+g[t].hash).empty()},7e3)},success:function(e,i,a){y(g[t],e)}}))):function(i){i.state="closed",p("#"+i.frame_id).slideUp(function(){p("#"+i.button_id).removeClass("wblib-visible");var e=d.getElementById(i.frame_id);e&&e.parentElement.removeChild(e)})}(g[t])}function x(e){s.spinner.stop(e.spinner_id)}function y(a,e){var t=!1;e&&!v[a.embed_url]&&(v[a.embed_url]=e);var i=d.getElementById(a.frame_id);i&&i.parentElement.removeChild(i);var s,n,r=p('<iframe id="'+a.frame_id+'" class="wblib-settings-doc-frame wblib-hide"></iframe>');p("#"+a.frame_container_id).append(r),(i=r[0]).document?s=i.document:(n=i.contentWindow)&&(s=n.document),r.on("load",function(){if(x(a),function(e){e.state="opened",p("#"+e.button_id).addClass("wblib-visible"),p("#"+e.frame_id).slideDown()}(a),!t&&a.embed_url_hash&&s){t=!0;var e=s.getElementById(a.embed_url_hash);if(e){var i=e.getBoundingClientRect();n.scrollTo(0,i.top)}}}),s.open(),s.writeln(e),s.close()}p(d).ready(function(){try{p(e).on("click",c),p(a).wpColorPicker(),p(t).on("click",u),p(r).on("click",m),p(".js-wbamp-show-if").each(b),w(),(l=p("a.js-wblib-tab-upgrade")).length&&p(".js-wblib-upgrade-link").on("click",_),p(".js-wblib-settings-doc-embed").click(j)}catch(e){console.log("wbLib: error setting up javascript: "+e.message)}}),s.setCookie=f,s.getCookie=function(e){return e&&decodeURIComponent(d.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},s.deleteCookie=function(e){f(encodeURIComponent(e),"",-1)},s.doc_embed={showHelp:j,displayHelp:y}}(window.wblib=window.wblib||{},window,document,jQuery);
